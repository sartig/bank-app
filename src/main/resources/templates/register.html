<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Registration</title>
    <link rel="stylesheet" href="/css/login.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
</head>
<body>
<div class="container">
    <form method="post" action="register" th:object="${user}">
        <div class="svg-container">
            <img src="/svg/iconblack.svg" alt="Icon" width="150" height="150">
        </div>
        <h2 style="font-size: 34px; color: #121212;">User Registration</h2>
        <h2 th:if="${unsuccessfulMessage}" style="color: orange;" th:text="${unsuccessfulMessage}"></h2>
        <input type="text" name="username" placeholder="Username" required>
        <input type="password" name="password" id="password" placeholder="Password" required oninput="checkPasswordStrength()" onblur="hidePasswordStrength()">
        <input type="checkbox" onclick="togglePasswordVisibility()">
        <br>
        <input type="password" name="confirmPassword" id="confirmPassword" placeholder="Confirm Password" required>
        <input type="checkbox" onclick="toggleConfirmPasswordVisibility()">
        <div id="passwordStrength" style="color: black; display: none;">Password Strength: </div>
        <div class="action-buttons">
            <button type="submit" class="purple-button">Register</button>
            <button type="button" class="white-button" onclick="window.location.href='/index'">Back</button>
        </div>
    </form>
</div>

<script>
    function togglePasswordVisibility() {
        var passwordInput = document.getElementById("password");
        if (passwordInput.type === "password") {
            passwordInput.type = "text";
        } else {
            passwordInput.type = "password";
        }
    }

    function toggleConfirmPasswordVisibility() {
        var confirmPasswordInput = document.getElementById("confirmPassword");
        if (confirmPasswordInput.type === "password") {
            confirmPasswordInput.type = "text";
        } else {
            confirmPasswordInput.type = "password";
        }
    }
    
    function checkPasswordStrength() {
	    var password = document.getElementById("password").value;
	    var sum = 0;
	    var strength = "Weak";
	    var color = "red";
	
	    for (var i = 0; i < password.length; i++) {
	        var charCode = password.charCodeAt(i);
	        
	        if ((charCode >= 97 && charCode <= 122) || (charCode >= 48 && charCode <= 57)) {
	            // 1. Increase sum by 1 for lowercase letter (first check) or number (second check)
	            sum += 1;
	        } else if (charCode >= 65 && charCode <= 90) {
	            // 2. Incrase sum by 2 for uppercase letter
	            sum += 2;
	        } else {
				// 3. Increase sum by 3 for special character
				sum += 3
			}
	    }
	
	    if (sum >= 10) {
	        strength = "Strong";
	        color = "green";
	    } else if (sum >= 7) {
	        strength = "Medium";
	        color = "orange";
	    }
	
	    document.getElementById("passwordStrength").innerText = "Password Strength: " + strength;
	    document.getElementById("passwordStrength").style.color = color;
	    document.getElementById("passwordStrength").style.display = password.length > 0 ? "block" : "none";
	}
    
    function hidePasswordStrength() {
		document.getElementById("passwordStrength").style.display = "none";
	}
</script>
</body>
</html>
